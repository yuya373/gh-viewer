query repository(
  $owner: String!,
  $name: String!,
  $pullRequestStates: [PullRequestState!],
  $pullRequestOrderField: IssueOrderField!,
  $pullRequestOrderDirection: OrderDirection!,
  $pullRequestBefore: String,
  $reviewRequestAfter: String,
  $reviewsAfter: String,
  $reviewCommentsAfter: String,
  $assigneesAfter: String,
  $labelsAfter: String
) {
  repository(owner: $owner, name: $name) {
    id
    name
    nameWithOwner
    owner {
      avatarUrl
      login
      url
    }
    pullRequests(
      last: 20,
      before: $pullRequestBefore,
      states: $pullRequestStates,
      orderBy: { field: $pullRequestOrderField, direction: $pullRequestOrderDirection }
    ) {
      nodes {
        assignees(first: 20, after: $assigneesAfter) {
          nodes {
            ...actor
          }
          pageInfo {
            ...pageInfo
          }
        }
        labels(first: 20, after: $labelsAfter) {
          nodes {
            color
            name
          }
          pageInfo {
            ...pageInfo
          }
        }
        comments(first: 20) {
          nodes {
            id
            ...comment
          }
          pageInfo {
            ...pageInfo
          }
          totalCount
        }
        reviewRequests(first: 20, after: $reviewRequestAfter) {
          nodes {
            reviewer {
              ...actor
            }
          }
          pageInfo {
            ...pageInfo
          }
          totalCount
        }
        reviews(first: 20, after: $reviewsAfter) {
          nodes {
            comments(first: 20, after: $reviewCommentsAfter) {
              nodes {
                id
                ...comment
                # reactionGroups {
                # }
              }
              pageInfo {
                ...pageInfo
              }
              totalCount
            }
            ...comment
            state
          }
          pageInfo {
            ...pageInfo
          }
        }
        id
        number
        title
        author
        headRefName
        baseRefName
        mergeable
        merged
        mergedAt
        state
        url
        publishedAt
        ...comment
      }
      pageInfo {
        ...pageInfo
      }
      totalCount
    }
  }
}

fragment pageInfo on PageInfo {
  startCursor
  endCursor
  hasNextPage
  hasPreviousPage
}

fragment comment on Comment {
  body
  author {
    ...actor
  }
  publishedAt
  editor {
    ...actor
  }
  lastEditedAt
}

fragment actor on Actor {
  avatarUrl
  login
  url
}
